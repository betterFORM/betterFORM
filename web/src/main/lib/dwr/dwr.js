if(typeof dwr=="undefined"){dwr={}}(function(){if(!dwr.engine){dwr.engine={}}dwr.engine.setErrorHandler=function(handler){dwr.engine._errorHandler=handler};dwr.engine.setWarningHandler=function(handler){dwr.engine._warningHandler=handler};dwr.engine.setTextHtmlHandler=function(handler){dwr.engine._textHtmlHandler=handler};dwr.engine.setPollStatusHandler=function(handler){dwr.engine._pollStatusHandler=handler};dwr.engine.setTimeout=function(timeout){dwr.engine._timeout=timeout};dwr.engine.setPreHook=function(handler){dwr.engine._preHook=handler};dwr.engine.setPostHook=function(handler){dwr.engine._postHook=handler};dwr.engine.setHeaders=function(headers){dwr.engine._headers=headers};dwr.engine.setAttributes=function(attributes){dwr.engine._attributes=attributes};dwr.engine.setOrdered=function(ordered){dwr.engine._ordered=ordered};dwr.engine.setAsync=function(async){dwr.engine._async=async};dwr.engine.setActiveReverseAjax=function(activeReverseAjax){if(activeReverseAjax){if(dwr.engine._activeReverseAjax){return}dwr.engine._retryIntervals=dwr.engine._defaultRetryIntervals;dwr.engine._activeReverseAjax=true;dwr.engine._poll()}else{if(dwr.engine._activeReverseAjax&&dwr.engine._pollBatch){dwr.engine.transport.abort(dwr.engine._pollBatch)}dwr.engine._activeReverseAjax=false}};dwr.engine.setNotifyServerOnPageUnload=function(notify,asyncUnload){dwr.engine._asyncUnload=(asyncUnload!==undefined)?asyncUnload:false;dwr.engine._isNotifyServerOnPageUnload=notify};dwr.engine.setMaxRetries=function(maxRetries){dwr.engine._maxRetries=maxRetries};dwr.engine.setRetryIntervals=function(intervalsArray){dwr.engine._retryIntervals=intervalsArray};dwr.engine.defaultErrorHandler=function(message,ex){dwr.engine._debug("Error: "+ex.name+", "+ex.message,true);if(message==null||message==""){alert("A server error has occurred.")}else{if(message.indexOf("0x80040111")!=-1){dwr.engine._debug(message)}else{alert(message)}}};dwr.engine.defaultWarningHandler=function(message,ex){dwr.engine._debug(message)};dwr.engine.defaultPollStatusHandler=function(newStatus,ex){dwr.engine._debug("pollStatusHandler - online: "+newStatus)};dwr.engine.beginBatch=function(){if(dwr.engine._batch){dwr.engine._handleError(null,{name:"dwr.engine.batchBegun",message:"Batch already begun"});return}dwr.engine._batch=dwr.engine.batch.create()};dwr.engine.endBatch=function(options){var batch=dwr.engine._batch;if(batch==null){dwr.engine._handleError(null,{name:"dwr.engine.batchNotBegun",message:"No batch in progress"});return}dwr.engine._batch=null;if(batch.map.callCount==0){return}if(options){dwr.engine.batch.merge(batch,options)}if(batch.async&&(dwr.engine._ordered||dwr.engine._internalOrdered)&&dwr.engine._batchesLength!=0){dwr.engine._batchQueue[dwr.engine._batchQueue.length]=batch}else{return dwr.engine.transport.send(batch)}};dwr.engine.openInDownload=function(data){var div=document.createElement("div");document.body.appendChild(div);div.innerHTML="<iframe width='0' height='0' scrolling='no' frameborder='0' src='"+data+"'></iframe>"};dwr.version={major:parseInt("3"),minor:parseInt("0"),revision:parseInt("0"),build:parseInt("312"),title:"RC2-final",label:"3.0.0-RC2-final-312"};dwr.engine._allowGetForSafariButMakeForgeryEasier="false";dwr.engine._scriptTagProtection="throw 'allowScriptTagRemoting is false.';";if(typeof pathToDwrServlet!="undefined"){dwr.engine._pathToDwrServlet=pathToDwrServlet}else{dwr.engine._pathToDwrServlet="/betterform/Flux"}dwr.engine._contextPath="/betterform";dwr.engine._pollWithXhr="false";dwr.engine._pollOnline=true;dwr.engine._ModePlainCall="/call/plaincall/";dwr.engine._ModePlainPoll="/call/plainpoll/";dwr.engine._ModeHtmlCall="/call/htmlcall/";dwr.engine._ModeHtmlPoll="/call/htmlpoll/";dwr.engine._async=Boolean("true");dwr.engine._pageId=null;dwr.engine._dwrSessionId=null;dwr.engine._scriptSessionId="";dwr.engine._preHook=null;dwr.engine._postHook=null;dwr.engine._batches={};dwr.engine._batchesLength=0;dwr.engine._batchQueue=[];dwr.engine._ordered=false;dwr.engine._internalOrdered=false;dwr.engine._batch=null;dwr.engine._timeout=0;dwr.engine._activeReverseAjax=false;dwr.engine._pollBatch=null;dwr.engine._pollCometInterval=200;dwr.engine.SSL_SECURE_URL="about:blank";dwr.engine._retries=0;dwr.engine._maxRetries=-1;dwr.engine._retryIntervals=[];dwr.engine._defaultRetryIntervals=[1,1,10];dwr.engine._textHtmlHandler=null;dwr.engine._headers=null;dwr.engine._attributes=null;dwr.engine._nextBatchId=0;dwr.engine._instanceId=-1;dwr.engine._propnames=["async","timeout","errorHandler","warningHandler","textHtmlHandler"];dwr.engine._partialResponseNo=0;dwr.engine._partialResponseYes=1;dwr.engine._partialResponseFlush=2;dwr.engine._isNotifyServerOnPageUnload=false;dwr.engine._asyncUnload=false;dwr.engine._mappedClasses={};dwr.engine._errorHandler=dwr.engine.defaultErrorHandler;dwr.engine._warningHandler=dwr.engine.defaultWarningHandler;dwr.engine._pollStatusHandler=dwr.engine.defaultPollStatusHandler;dwr.engine._postSeperator="\n";dwr.engine._defaultInterceptor=function(data){return data};dwr.engine._urlRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._contentRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._replyRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._excludeObjectAttributes={"$dwrClassName":true,"$dwrByRef":true,"$_dwrConversionRef":true};dwr.engine._unloading=false;dwr.engine._unloader=function(){dwr.engine._unloading=true;dwr.engine._batchQueue.length=0;var batch;for(var batchId in dwr.engine._batches){batch=dwr.engine._batches[batchId];if(batch&&batch.map){if(batch.req){batch.req.abort()}}}if(dwr.engine._isNotifyServerOnPageUnload){dwr.engine._debug("calling unloader for: "+dwr.engine._scriptSessionId);batch={map:{callCount:1,"c0-scriptName":"__System","c0-methodName":"pageUnloaded","c0-id":0},paramCount:0,isPoll:false,async:dwr.engine._asyncUnload,headers:{},preHooks:[],postHooks:[],timeout:dwr.engine._timeout,errorHandler:null,warningHandler:null,textHtmlHandler:null,path:dwr.engine._pathToDwrServlet,handlers:[{exceptionHandler:null,callback:null}]};dwr.engine.transport.send(batch);dwr.engine._isNotifyServerOnPageUnload=false}};function ignoreIfUnloading(batch,f){if(dwr.engine._unloading){return}if(batch&&batch.async==false){f()}else{setTimeout(function(){if(dwr.engine._unloading){return}f()},100)}}dwr.engine._execute=function(path,scriptName,methodName,args){var singleShot=false;if(dwr.engine._batch==null){dwr.engine.beginBatch();singleShot=true}var batch=dwr.engine._batch;if(batch.path==null){batch.path=path}else{if(batch.path!=path){dwr.engine._handleError(batch,{name:"dwr.engine.multipleServlets",message:"Can't batch requests to multiple DWR Servlets."});return}}dwr.engine.batch.addCall(batch,scriptName,methodName,args);batch.map.callCount++;if(singleShot){return dwr.engine.endBatch()}};dwr.engine._poll=function(){if(!dwr.engine._activeReverseAjax){return}dwr.engine._pollBatch=dwr.engine.batch.createPoll();dwr.engine.transport.send(dwr.engine._pollBatch)};dwr.engine._eval=function(script){if(script==null){return null}if(script==""){dwr.engine._debug("Warning: blank script",true);return null}return eval(script)};dwr.engine._callPostHooks=function(batch){if(batch.postHooks){for(var i=0;i<batch.postHooks.length;i++){batch.postHooks[i]()}batch.postHooks=null}};dwr.engine._handleError=function(batch,ex){var errorHandlers=[];if(dwr.engine._retries<=1){if(batch){for(var i=0;i<batch.map.callCount;i++){var handlers=batch.handlers[i];if(!handlers.completed){if(typeof handlers.errorHandler=="function"){errorHandlers.push(handlers.errorHandler)}handlers.completed=true}}}if(batch){dwr.engine.batch.remove(batch)}}ignoreIfUnloading(batch,function(){if(dwr.engine._retries<=1){dwr.engine._prepareException(ex);var errorHandler;while(errorHandlers.length>0){errorHandler=errorHandlers.shift();errorHandler(ex.message,ex)}if(batch&&typeof batch.errorHandler=="function"){batch.errorHandler(ex.message,ex)}else{if(dwr.engine._errorHandler){dwr.engine._errorHandler(ex.message,ex)}}}})};dwr.engine._handlePollRetry=function(batch,ex){var retryInterval;if(batch&&batch.isPoll){if(dwr.engine._retries<dwr.engine._retryIntervals.length){retryInterval=dwr.engine._retryIntervals[dwr.engine._retries]*1000}else{retryInterval=dwr.engine._retryIntervals[dwr.engine._retryIntervals.length-1]*1000}if(dwr.engine._maxRetries==-1||dwr.engine._retries<=dwr.engine._maxRetries){if(dwr.engine._retries==dwr.engine._retryIntervals.length-1){dwr.engine._debug("poll retry - going offline: "+retryInterval/1000+" seconds");dwr.engine._handlePollStatusChange(false,ex)}dwr.engine._retries++;dwr.engine.batch.remove(batch);dwr.engine._debug("poll retry - interval: "+retryInterval/1000+" seconds");setTimeout(dwr.engine._poll,retryInterval)}else{dwr.engine._debug("max retries reached, stop polling for server status.")}}};dwr.engine._handlePollStatusChange=function(newStatus,ex){if(!newStatus){dwr.engine._pollOnline=false}if(typeof dwr.engine._pollStatusHandler){dwr.engine._pollStatusHandler(newStatus,ex)}if(newStatus){dwr.engine._pollOnline=true;dwr.engine._retries=0}};dwr.engine._handleWarning=function(batch,ex){ignoreIfUnloading(batch,function(){dwr.engine._prepareException(ex);if(batch&&typeof batch.warningHandler=="function"){batch.warningHandler(ex.message,ex)}else{if(dwr.engine._warningHandler){dwr.engine._warningHandler(ex.message,ex)}}if(batch){dwr.engine.batch.remove(batch)}})};dwr.engine._prepareException=function(ex){if(typeof ex=="string"){ex={name:"unknown",message:ex}}if(ex.message==null){ex.message=""}if(ex.name==null){ex.name="unknown"}};dwr.engine._delegate=(function(){function F(){}return(function(obj){F.prototype=obj;return new F()})})();dwr.engine._createFromMap=function(map){var obj=new this();for(prop in map){if(map.hasOwnProperty(prop)){obj[prop]=map[prop]}}return obj};dwr.engine._global=(function(){return this}).call(null);dwr.engine._getObject=function(prop){var parts=prop.split(".");var value;var scope=dwr.engine._global;while(parts.length>0){var currprop=parts.shift();value=scope[currprop];if(parts.length>0&&value==null){return undefined}scope=value}return value};dwr.engine._setObject=function(prop,obj){var parts=prop.split(".");var level;var scope=dwr.engine._global;while(parts.length>0){var currprop=parts.shift();if(parts.length==0){scope[currprop]=obj}else{level=scope[currprop];if(level==null){scope[currprop]=level={}}scope=level}}};dwr.engine._debug=function(message,stacktrace){var written=false;try{if(window.console){if(stacktrace&&window.console.trace){window.console.trace()}window.console.log(message);written=true}else{if(window.opera&&window.opera.postError){window.opera.postError(message);written=true}else{if(window.Jaxer&&Jaxer.isOnServer){Jaxer.Log.info(message);written=true}}}}catch(ex){}if(!written){var debug=document.getElementById("dwr-debug");if(debug){var contents=message+"<br/>"+debug.innerHTML;if(contents.length>2048){contents=contents.substring(0,2048)}debug.innerHTML=contents}}};dwr.engine.remote={handleCallback:function(batchId,callId,reply){var batch=dwr.engine._batches[batchId];if(batch==null){dwr.engine._debug("Warning: batch == null in remoteHandleCallback for batchId="+batchId,true);return}batch.reply=reply;try{var handlers=batch.handlers[callId];if(!handlers){dwr.engine._debug("Warning: Missing handlers. callId="+callId,true)}else{batch.handlers[callId].completed=true;if(typeof handlers.callback=="function"){handlers.callback.apply(handlers.callbackScope,[reply,handlers.callbackArg])}}}catch(ex){dwr.engine._handleError(batch,ex)}},handleFunctionCall:function(id,args){var func=dwr.engine.serialize.remoteFunctions[id];func.apply(window,args)},handleObjectCall:function(id,methodName,args){var obj=dwr.engine.serialize.remoteFunctions[id];obj[methodName].apply(obj,args)},handleSetCall:function(id,propertyName,data){var obj=dwr.engine.serialize.remoteFunctions[id];obj[propertyName]=data},handleFunctionClose:function(id){delete dwr.engine.serialize.remoteFunctions[id]},handleException:function(batchId,callId,ex){var batch=dwr.engine._batches[batchId];if(batch==null){dwr.engine._debug("Warning: null batch in remoteHandleException",true);return}var handlers=batch.handlers[callId];batch.handlers[callId].completed=true;if(handlers==null){dwr.engine._debug("Warning: null handlers in remoteHandleException",true);return}if(ex.message==undefined){ex.message=""}if(typeof handlers.exceptionHandler=="function"){handlers.exceptionHandler.call(handlers.exceptionScope,ex.message,ex,handlers.exceptionArg)}else{if(typeof batch.errorHandler=="function"){batch.errorHandler(ex.message,ex)}}},handleBatchException:function(ex,batchId){var searchBatch=(dwr.engine._receivedBatch==null&&batchId!=null);if(searchBatch){dwr.engine._receivedBatch=dwr.engine._batches[batchId]}if(ex.message==undefined){ex.message=""}dwr.engine._handleError(dwr.engine._receivedBatch,ex);if(searchBatch){dwr.engine._receivedBatch=null;dwr.engine.batch.remove(dwr.engine._batches[batchId])}},handleNewWindowName:function(windowName){dwr.engine._debug("Setting new window name: "+windowName);if(window.name!=null&&window.name!=""){dwr.engine._debug("- Warning: This will override existing name of: "+window.name)}window.name=windowName},handleForeign:function(windowName,script){var foreign=window.open(null,windowName);if(foreign!=null){if(foreign.dwr!=null){foreign.dwr.engine._eval(script)}else{dwr.engine._debug("Found window, but DWR did not exist in it")}}else{dwr.engine._debug("Could not find window")}},pollCometDisabled:function(ex,batchId){dwr.engine.setActiveReverseAjax(false);var searchBatch=(dwr.engine._receivedBatch==null&&batchId!=null);if(searchBatch){dwr.engine._receivedBatch=dwr.engine._batches[batchId]}if(ex.message==undefined){ex.message=""}dwr.engine._handleError(dwr.engine._receivedBatch,ex);if(searchBatch){dwr.engine._receivedBatch=null;dwr.engine.batch.remove(dwr.engine._batches[batchId])}},newObject:function(dwrClassName,memberMap){var classfunc=dwr.engine._mappedClasses[dwrClassName];if(classfunc&&classfunc.createFromMap){return classfunc.createFromMap(memberMap)}else{memberMap.$dwrClassName=dwrClassName;return memberMap}}};dwr.engine.serialize={domDocument:["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],remoteFunctions:{},funcId:0,toDomElement:function(xml){return dwr.engine.serialize.toDomDocument(xml).documentElement},toDomDocument:function(xml){var dom;if(window.DOMParser){var parser=new DOMParser();dom=parser.parseFromString(xml,"text/xml");if(!dom.documentElement||dom.documentElement.tagName=="parsererror"){var message=dom.documentElement.firstChild.data;message+="\n"+dom.documentElement.firstChild.nextSibling.firstChild.data;throw message}return dom}else{if(window.ActiveXObject){dom=dwr.engine.util.newActiveXObject(dwr.engine.serialize.domDocument);dom.loadXML(xml);return dom}else{var div=document.createElement("div");div.innerHTML=xml;return div}}},convert:function(batch,directrefmap,otherrefmap,data,name,depth){if(data==null){batch.map[name]="null:null";return}switch(typeof data){case"boolean":batch.map[name]="boolean:"+data;break;case"number":batch.map[name]="number:"+data;break;case"string":batch.map[name]="string:"+encodeURIComponent(data);break;case"object":var ref=dwr.engine.serialize.lookup(directrefmap,otherrefmap,data,name);var objstr=Object.prototype.toString.call(data);if(data.$dwrByRef){batch.map[name]=dwr.engine.serialize.convertByReference(batch,directrefmap,otherrefmap,data,name,depth+1)}else{if(ref!=null){batch.map[name]=ref}else{if(objstr=="[object String]"){batch.map[name]="string:"+encodeURIComponent(data)}else{if(objstr=="[object Boolean]"){batch.map[name]="boolean:"+data}else{if(objstr=="[object Number]"){batch.map[name]="number:"+data}else{if(objstr=="[object Date]"){batch.map[name]="date:"+data.getTime()}else{if(objstr=="[object Array]"){batch.map[name]=dwr.engine.serialize.convertArray(batch,directrefmap,otherrefmap,data,name,depth+1)}else{if(data&&data.tagName&&data.tagName.toLowerCase()=="input"&&data.type&&data.type.toLowerCase()=="file"){batch.fileUpload=true;batch.map[name]=data}else{if(data.nodeName&&data.nodeType){batch.map[name]=dwr.engine.serialize.convertXml(batch,directrefmap,otherrefmap,data,name,depth+1)}else{batch.map[name]=dwr.engine.serialize.convertObject(batch,directrefmap,otherrefmap,data,name,depth+1)}}}}}}}}}break;case"function":if(depth==0){batch.map[name]=dwr.engine.serialize.convertByReference(batch,directrefmap,otherrefmap,data,name,depth+1)}break;default:dwr.engine._handleWarning(null,{name:"dwr.engine.unexpectedType",message:"Unexpected type: "+typeof data+", attempting default converter."});batch.map[name]="default:"+data;break}},convertByReference:function(batch,directrefmap,otherrefmap,data,name,depth){var funcId="f"+dwr.engine.serialize.funcId;dwr.engine.serialize.remoteFunctions[funcId]=data;dwr.engine.serialize.funcId++;return"byref:"+funcId},convertArray:function(batch,directrefmap,otherrefmap,data,name,depth){var childName,i;if(dwr.engine.isIE<=7){var buf=["array:["];for(i=0;i<data.length;i++){if(i!=0){buf.push(",")}batch.paramCount++;childName="c"+dwr.engine._batch.map.callCount+"-e"+batch.paramCount;dwr.engine.serialize.convert(batch,directrefmap,otherrefmap,data[i],childName,depth+1);buf.push("reference:");buf.push(childName)}buf.push("]");reply=buf.join("")}else{var reply="array:[";for(i=0;i<data.length;i++){if(i!=0){reply+=","}batch.paramCount++;childName="c"+dwr.engine._batch.map.callCount+"-e"+batch.paramCount;dwr.engine.serialize.convert(batch,directrefmap,otherrefmap,data[i],childName,depth+1);reply+="reference:";reply+=childName}reply+="]"}return reply},convertObject:function(batch,directrefmap,otherrefmap,data,name,depth){var reply="Object_"+dwr.engine.serialize.getObjectClassName(data).replace(/:/g,"?")+":{";var elementset=(data.constructor&&data.constructor.$dwrClassMembers?data.constructor.$dwrClassMembers:data);var element;for(element in elementset){if(typeof data[element]!="function"&&!dwr.engine._excludeObjectAttributes[element]){batch.paramCount++;var childName="c"+dwr.engine._batch.map.callCount+"-e"+batch.paramCount;dwr.engine.serialize.convert(batch,directrefmap,otherrefmap,data[element],childName,depth+1);reply+=encodeURIComponent(element)+":reference:"+childName+", "}}if(reply.substring(reply.length-2)==", "){reply=reply.substring(0,reply.length-2)}reply+="}";return reply},convertXml:function(batch,directrefmap,otherrefmap,data,name,depth){var output;if(window.XMLSerializer){output=new XMLSerializer().serializeToString(data)}else{if(data.toXml){output=data.toXml}else{output=data.innerHTML}}return"xml:"+encodeURIComponent(output)},lookup:function(directrefmap,otherrefmap,data,name){var ref;if("$_dwrConversionRef" in data){ref=data.$_dwrConversionRef;if(ref&&directrefmap[ref]!=data){ref=null}}if(ref==null){for(r in otherrefmap){if(otherrefmap[r]==data){ref=r;break}}}if(ref!=null){return"reference:"+ref}try{data.$_dwrConversionRef=name;directrefmap[name]=data}catch(err){otherrefmap[name]=data}return null},cleanup:function(directrefmap){for(name in directrefmap){var data=directrefmap[name];try{delete data.$_dwrConversionRef}catch(err){data.$_dwrConversionRef=undefined}}},getObjectClassName:function(obj){if(obj.$dwrClassName){return obj.$dwrClassName}else{if(obj.constructor&&obj.constructor.$dwrClassName){return obj.constructor.$dwrClassName}else{return"Object"}}}};dwr.engine.transport={send:function(batch){dwr.engine.transport.updateDwrSessionFromCookie();if(!dwr.engine._dwrSessionId){dwr.engine._internalOrdered=true;var idbatch={map:{callCount:1,"c0-scriptName":"__System","c0-methodName":"generateId","c0-id":0},paramCount:0,isPoll:false,async:batch.async,headers:{},preHooks:[],postHooks:[function(){dwr.engine._internalOrdered=false}],timeout:dwr.engine._timeout,errorHandler:batch.errorHandler,warningHandler:batch.warningHandler,textHtmlHandler:batch.textHtmlHandler,path:batch.path,handlers:[{exceptionHandler:null,callback:function(id){dwr.engine.transport.updateDwrSessionFromCookie();if(!dwr.engine._dwrSessionId){dwr.engine.transport.setDwrSession(id)}dwr.engine.transport.send2(batch)}}]};dwr.engine.transport.send2(idbatch)}else{dwr.engine.transport.send2(batch)}},send2:function(batch){dwr.engine.batch.prepareToSend(batch);var isCrossDomain=false;if(batch.path==null){batch.path=dwr.engine._pathToDwrServlet}if(batch.path.indexOf("http://")==0||batch.path.indexOf("https://")==0){var dwrShortPath=batch.path.split("/",3).join("/");var hrefShortPath=window.location.href.split("/",3).join("/");isCrossDomain=(dwrShortPath!=hrefShortPath)}if(batch.fileUpload){if(isCrossDomain){throw new Error("Cross domain file uploads are not possible with this release of DWR")}batch.transport=dwr.engine.transport.iframe}else{if(isCrossDomain&&!dwr.engine.isJaxerServer){batch.transport=dwr.engine.transport.scriptTag}else{batch.transport=dwr.engine.transport.xhr}}return batch.transport.send(batch)},complete:function(batch){dwr.engine.batch.validate(batch);dwr.engine.transport.remove(batch)},abort:function(batch){var transport=batch.transport;dwr.engine.transport.remove(batch);if(transport.abort){transport.abort(batch)}dwr.engine._handleError(batch,{name:"dwr.engine.timeout",message:"Timeout"})},remove:function(batch){if(batch.transport){dwr.engine._callPostHooks(batch);batch.transport.remove(batch);batch.transport=null}dwr.engine.batch.remove(batch)},setDwrSession:function(dwrsess){dwr.engine._dwrSessionId=dwrsess;document.cookie="DWRSESSIONID="+dwrsess+"; path="+(dwr.engine._contextPath!=""?dwr.engine._contextPath:"/");dwr.engine._scriptSessionId=dwrsess+"/"+dwr.engine._pageId},updateDwrSessionFromCookie:function(){if(!dwr.engine._dwrSessionId){var match=document.cookie.match(/(?:^|; )DWRSESSIONID=([^;]+)/);if(match){dwr.engine.transport.setDwrSession(match[1])}}},xhr:{httpMethod:"POST",XMLHTTP:["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],send:function(batch){if(batch.isPoll){batch.map.partialResponse=dwr.engine._partialResponseYes}if(batch.isPoll&&dwr.engine._pollWithXhr=="true"){batch.map.partialResponse=dwr.engine._partialResponseNo}if(batch.isPoll&&dwr.engine.isIE){batch.map.partialResponse=dwr.engine._partialResponseNo}if(window.XMLHttpRequest){batch.req=new XMLHttpRequest()}else{if(window.ActiveXObject){batch.req=dwr.engine.util.newActiveXObject(dwr.engine.transport.xhr.XMLHTTP)}}if(batch.async==true){batch.req.onreadystatechange=function(){if(typeof dwr!="undefined"){dwr.engine.transport.xhr.stateChange(batch)}}}httpMethod=dwr.engine.transport.xhr.httpMethod;var indexSafari=navigator.userAgent.indexOf("Safari/");if(indexSafari>=0){var version=navigator.userAgent.substring(indexSafari+7);if(parseInt(version,10)<400){if(dwr.engine._allowGetForSafariButMakeForgeryEasier=="true"){httpMethod="GET"}else{dwr.engine._handleWarning(batch,{name:"dwr.engine.oldSafari",message:"Safari GET support disabled. See getahead.org/dwr/server/servlet and allowGetForSafariButMakeForgeryEasier."})}}}batch.mode=batch.isPoll?dwr.engine._ModePlainPoll:dwr.engine._ModePlainCall;var request=dwr.engine.batch.constructRequest(batch,httpMethod);try{batch.req.open(httpMethod,request.url,batch.async);try{for(var prop in batch.headers){var value=batch.headers[prop];if(typeof value=="string"){batch.req.setRequestHeader(prop,value)}}if(!batch.headers["Content-Type"]){batch.req.setRequestHeader("Content-Type","text/plain")}}catch(ex){dwr.engine._handleWarning(batch,ex)}batch.req.send(request.body);if(batch.async==false){dwr.engine.transport.xhr.stateChange(batch)}}catch(ex){dwr.engine._handleError(batch,ex)}if(batch.isPoll&&batch.map.partialResponse==dwr.engine._partialResponseYes){dwr.engine.transport.xhr.checkCometPoll()}return batch.reply},stateChange:function(batch){var toEval;if(batch.completed){dwr.engine._debug("Error: _stateChange() with batch.completed");return}var req=batch.req;var status=0;try{if(req.readyState>=2){status=req.status}}catch(ignore){}if(status==0&&req.readyState<4){return}if(status==200&&!dwr.engine._pollOnline){dwr.engine._handlePollStatusChange(true)}if(req.readyState!=4){return}if(dwr.engine._unloading&&!dwr.engine.isJaxerServer){dwr.engine._debug("Ignoring reply from server as page is unloading.");return}try{var reply=req.responseText;reply=dwr.engine._replyRewriteHandler(reply);if(status!=200){dwr.engine._handleError(batch,{name:"dwr.engine.http."+status,message:req.statusText})}else{if(reply==null||reply==""){dwr.engine._handleError(batch,{name:"dwr.engine.missingData",message:"No data received from server"})}else{var contentType=req.getResponseHeader("Content-Type");if(dwr.engine.isJaxerServer){contentType="text/javascript"}if(!contentType.match(/^text\/plain/)&&!contentType.match(/^text\/javascript/)){if(contentType.match(/^text\/html/)&&typeof batch.textHtmlHandler=="function"){batch.textHtmlHandler({status:status,responseText:reply,contentType:contentType})}else{dwr.engine._handleWarning(batch,{name:"dwr.engine.invalidMimeType",message:"Invalid content type: '"+contentType+"'"})}}else{if(batch.isPoll&&batch.map.partialResponse==dwr.engine._partialResponseYes){dwr.engine.transport.xhr.processCometResponse(reply,batch)}else{if(reply.search("//#DWR")==-1){dwr.engine._handleWarning(batch,{name:"dwr.engine.invalidReply",message:"Invalid reply from server"})}else{toEval=reply}}}}}}catch(ex){dwr.engine._handleWarning(batch,ex)}dwr.engine._receivedBatch=batch;if(toEval!=null){toEval=toEval.replace(dwr.engine._scriptTagProtection,"")}dwr.engine._eval(toEval);dwr.engine._receivedBatch=null;dwr.engine.transport.complete(batch)},checkCometPoll:function(){var req=dwr.engine._pollBatch&&dwr.engine._pollBatch.req;if(req){var text=req.responseText;if(text!=null){dwr.engine.transport.xhr.processCometResponse(text,dwr.engine._pollBatch)}}if(dwr.engine._pollBatch){setTimeout(dwr.engine.transport.xhr.checkCometPoll,dwr.engine._pollCometInterval)}},processCometResponse:function(response,batch){if(batch.charsProcessed==response.length){return}if(response.length==0){batch.charsProcessed=0;return}var firstStartTag=response.indexOf("//#DWR-START#",batch.charsProcessed);if(firstStartTag==-1){batch.charsProcessed=response.length;return}var lastEndTag=response.lastIndexOf("//#DWR-END#");if(lastEndTag==-1){return}if(response.charCodeAt(lastEndTag+11)==13&&response.charCodeAt(lastEndTag+12)==10){batch.charsProcessed=lastEndTag+13}else{batch.charsProcessed=lastEndTag+11}var exec=response.substring(firstStartTag+13,lastEndTag);try{dwr.engine._receivedBatch=batch;dwr.engine._eval(exec);dwr.engine._receivedBatch=null}catch(ex){if(dwr!=null){dwr.engine._handleError(batch,ex)}}},abort:function(batch){if(batch.req){batch.req.abort()}},remove:function(batch){if(batch.req){delete batch.req}}},iframe:{httpMethod:"POST",send:function(batch){if(document.body==null){setTimeout(function(){dwr.engine.transport.iframe.send(batch)},100);return}batch.httpMethod=dwr.engine.transport.iframe.httpMethod;if(batch.fileUpload){batch.httpMethod="POST";batch.encType="multipart/form-data"}var idname=dwr.engine.transport.iframe.getId(batch);batch.div1=document.createElement("div");document.body.appendChild(batch.div1);batch.div1.innerHTML="<iframe src='"+dwr.engine.SSL_SECURE_URL+"' frameborder='0' style='width:0px;height:0px;border:0;display:none;' id='"+idname+"' name='"+idname+"'></iframe>";batch.iframe=batch.div1.firstChild;batch.document=document;batch.iframe.batch=batch;dwr.engine.transport.iframe.beginLoader(batch,idname)},getId:function(batch){return batch.isPoll?"dwr-if-poll-"+batch.map.batchId:"dwr-if-"+batch.map.batchId},beginLoader:function(batch,idname){if(batch.iframe.contentWindow.document.body==null){setTimeout(function(){dwr.engine.transport.iframe.beginLoader(batch,idname)},100);return}if(batch.isPoll){batch.map.partialResponse=dwr.engine._partialResponseYes}batch.mode=batch.isPoll?dwr.engine._ModeHtmlPoll:dwr.engine._ModeHtmlCall;var request=dwr.engine.batch.constructRequest(batch,batch.httpMethod);if(batch.httpMethod=="GET"){batch.iframe.setAttribute("src",request.url)}else{batch.div2=document.createElement("div");document.body.appendChild(batch.div2);batch.div2.innerHTML="<form"+(batch.encType?" encType='"+batch.encType+"' encoding='"+batch.encType+"'":"")+"></form>";batch.form=batch.div2.firstChild;batch.form.setAttribute("action",request.url);batch.form.setAttribute("target",idname);batch.form.setAttribute("style","display:none");batch.form.setAttribute("method",batch.httpMethod);for(var prop in batch.map){var value=batch.map[prop];if(typeof value!="function"){if(value&&value.tagName&&value.tagName.toLowerCase()=="input"&&value.type&&value.type.toLowerCase()=="file"){var clone=value.cloneNode(true);value.removeAttribute("id",prop);value.setAttribute("name",prop);value.style.display="none";value.parentNode.insertBefore(clone,value);value.parentNode.removeChild(value);batch.form.appendChild(value)}else{var formInput=batch.document.createElement("input");formInput.setAttribute("type","hidden");formInput.setAttribute("name",prop);formInput.setAttribute("value",value);batch.form.appendChild(formInput)}}}batch.form.submit()}},remote:{beginIFrameResponse:function(iframe,batchId){if(iframe!=null){dwr.engine._receivedBatch=iframe.batch}},endIFrameResponse:function(batchId){dwr.engine._receivedBatch=dwr.engine._batches[batchId];dwr.engine.transport.complete(dwr.engine._receivedBatch);dwr.engine._receivedBatch=null}},remove:function(batch){setTimeout(function(){if(batch.iframe&&batch.iframe.parentNode){batch.iframe.parentNode.removeChild(batch.iframe);batch.iframe=null}if(batch.div1&&batch.div1.parentNode){batch.div1.parentNode.removeChild(batch.div1);batch.div1=null}if(batch.form&&batch.form.parentNode){batch.form.parentNode.removeChild(batch.form);batch.form=null}if(batch.div2&&batch.div2.parentNode){batch.div2.parentNode.removeChild(batch.div2);batch.div2=null}},100)}},scriptTag:{send:function(batch){if(batch.isPoll){batch.map.partialResponse=dwr.engine._partialResponseNo}batch.mode=batch.isPoll?dwr.engine._ModePlainPoll:dwr.engine._ModePlainCall;var request=dwr.engine.batch.constructRequest(batch,"GET");batch.script=document.createElement("script");batch.script.id="dwr-st-"+batch.map.batchId;batch.script.src=request.url;batch.script.type="text/javascript";batch.script.async=true;dwr.engine.util.addEventListener(batch.script,"load",function(ev){if(typeof dwr!="undefined"){dwr.engine.transport.scriptTag.complete(batch)}});dwr.engine.util.addEventListener(batch.script,"error",function(ev){if(typeof dwr!="undefined"){dwr.engine.transport.scriptTag.complete(batch)}});dwr.engine.util.addEventListener(batch.script,"readystatechange",function(ev){if(typeof dwr!="undefined"){if(batch.script.readyState=="complete"||batch.script.readyState=="loaded"){dwr.engine.transport.scriptTag.complete(batch)}}});document.getElementsByTagName("head")[0].appendChild(batch.script)},complete:function(batch){dwr.engine.transport.complete(batch)},remove:function(batch){if(!batch.script){return}batch.script.parentNode.removeChild(batch.script);batch.script=null}},htmlfile:{send:function(batch){var idname=dwr.engine.transport.iframe.getId(batch);batch.htmlfile=new window.ActiveXObject("htmlfile");batch.htmlfile.open();batch.htmlfile.write("<html>");batch.htmlfile.write("<div><iframe className='wibble' src='javascript:void(0)' id='"+idname+"' name='"+idname+"' onload='dwr.engine.transport.iframe.loadingComplete("+batch.map.batchId+");'></iframe></div>");batch.htmlfile.write("</html>");batch.htmlfile.close();batch.htmlfile.parentWindow.dwr=dwr;batch.document=batch.htmlfile;dwr.engine.transport.iframe.beginLoader(batch,idname)}}};dwr.engine.batch={create:function(){var batch={async:dwr.engine._async,charsProcessed:0,handlers:[],isPoll:false,map:{callCount:0,windowName:window.name},paramCount:0,preHooks:[],postHooks:[],timeout:dwr.engine._timeout,errorHandler:dwr.engine._errorHandler,warningHandler:dwr.engine._warningHandler,textHtmlHandler:dwr.engine._textHtmlHandler};if(dwr.engine._preHook){batch.preHooks.push(dwr.engine._preHook)}if(dwr.engine._postHook){batch.postHooks.push(dwr.engine._postHook)}dwr.engine.batch.populateHeadersAndAttributes(batch);return batch},createPoll:function(){var batch={async:true,charsProcessed:0,handlers:[{callback:function(pause){dwr.engine._pollBatch=null;setTimeout(dwr.engine._poll,pause)}}],isPoll:true,map:{windowName:window.name,callCount:1},paramCount:0,path:dwr.engine._pathToDwrServlet,preHooks:[],postHooks:[],timeout:0,windowName:window.name};dwr.engine.batch.populateHeadersAndAttributes(batch);return batch},populateHeadersAndAttributes:function(batch){var propname,data;batch.headers={};if(dwr.engine._headers){for(propname in dwr.engine._headers){data=dwr.engine._headers[propname];if(typeof data!="function"){batch.headers[propname]=data}}}batch.attributes={};if(dwr.engine._attributes){for(propname in dwr.engine._attributes){data=dwr.engine._attributes[propname];if(typeof data!="function"){batch.attributes[propname]=data}}}},addCall:function(batch,scriptName,methodName,args){var callData,stopAt;var lastArg=args[args.length-1];if(lastArg==null||typeof lastArg=="function"){callData={callback:lastArg};stopAt=args.length-1}else{if(typeof lastArg=="object"&&(typeof lastArg.callback=="function"||typeof lastArg.exceptionHandler=="function"||typeof lastArg.callbackHandler=="function"||typeof lastArg.errorHandler=="function"||typeof lastArg.warningHandler=="function")){callData=lastArg;stopAt=args.length-1}else{callData={};stopAt=args.length}}dwr.engine.batch.merge(batch,callData);batch.handlers[batch.map.callCount]={exceptionHandler:callData.exceptionHandler,exceptionArg:callData.exceptionArg||callData.arg||null,exceptionScope:callData.exceptionScope||callData.scope||window,callback:callData.callbackHandler||callData.callback,callbackArg:callData.callbackArg||callData.arg||null,callbackScope:callData.callbackScope||callData.scope||window};var prefix="c"+batch.map.callCount+"-";batch.map[prefix+"scriptName"]=scriptName;batch.map[prefix+"methodName"]=methodName;batch.map[prefix+"id"]=batch.map.callCount;var directrefmap={},otherrefmap={};for(var i=0;i<stopAt;i++){dwr.engine.serialize.convert(batch,directrefmap,otherrefmap,args[i],prefix+"param"+i,0)}dwr.engine.serialize.cleanup(directrefmap)},merge:function(batch,overrides){var propname,data;for(var i=0;i<dwr.engine._propnames.length;i++){propname=dwr.engine._propnames[i];if(overrides[propname]!=null){batch[propname]=overrides[propname]}}if(overrides.preHook!=null){batch.preHooks.unshift(overrides.preHook)}if(overrides.postHook!=null){batch.postHooks.push(overrides.postHook)}if(overrides.headers){for(propname in overrides.headers){data=overrides.headers[propname];if(typeof data!="function"){batch.headers[propname]=data}}}var attrs=null;if(overrides.attributes){attrs=overrides.attributes}if(attrs){for(propname in attrs){data=attrs[propname];if(typeof data!="function"){batch.attributes[propname]=data}}}},prepareToSend:function(batch){batch.map.batchId=dwr.engine._nextBatchId;dwr.engine._nextBatchId++;dwr.engine._batches[batch.map.batchId]=batch;dwr.engine._batchesLength++;batch.completed=false;batch.map.instanceId=dwr.engine._instanceId;batch.map.page=encodeURIComponent(window.location.pathname+window.location.search);batch.map.scriptSessionId=dwr.engine._scriptSessionId;batch.map.windowName=window.name;for(var i=0;i<batch.preHooks.length;i++){batch.preHooks[i]()}batch.preHooks=null;if(batch.timeout&&batch.timeout!=0){batch.timeoutId=setTimeout(function(){dwr.engine.transport.abort(batch)},batch.timeout)}},constructRequest:function(batch,httpMethod){var urlBuffer=[];urlBuffer.push(batch.path);urlBuffer.push(batch.mode);if(batch.isPoll){urlBuffer.push("ReverseAjax.dwr")}else{if(batch.map.callCount==1){urlBuffer.push(batch.map["c0-scriptName"]);urlBuffer.push(".");urlBuffer.push(batch.map["c0-methodName"]);urlBuffer.push(".dwr")}else{urlBuffer.push("Multiple.");urlBuffer.push(batch.map.callCount);urlBuffer.push(".dwr")}}var sessionMatchExpr=new RegExp("^[^;\\?#]+(;[^\\?#]+)");var sessionMatch=location.href.match(sessionMatchExpr);if(sessionMatch!=null){urlBuffer.push(sessionMatch[1])}if(batch.attributes){for(var attrname in batch.attributes){var data=batch.attributes[attrname];if(typeof data!="function"){batch.map["a-"+attrname]=""+data}}}var request={};var prop;if(httpMethod=="GET"){batch.map.callCount=""+batch.map.callCount;urlBuffer.push("?");for(prop in batch.map){if(typeof batch.map[prop]!="function"){urlBuffer.push(encodeURIComponent(prop));urlBuffer.push("=");urlBuffer.push(encodeURIComponent(batch.map[prop]));urlBuffer.push("&")}}urlBuffer.pop();request.body=null}else{request.body="";if(dwr.engine.isIE<=7){var buf=[];for(prop in batch.map){if(typeof batch.map[prop]!="function"){buf.push(prop+"="+batch.map[prop]+dwr.engine._postSeperator)}}request.body=buf.join("")}else{for(prop in batch.map){if(typeof batch.map[prop]!="function"){request.body+=prop+"="+batch.map[prop]+dwr.engine._postSeperator}}}request.body=dwr.engine._contentRewriteHandler(request.body)}request.url=dwr.engine._urlRewriteHandler(urlBuffer.join(""));return request},validate:function(batch){if(!batch.completed){for(var i=0;i<batch.map.callCount;i++){if(batch.handlers[i].completed!==true){dwr.engine._handleError(batch,{name:"dwr.engine.incompleteReply",message:"Incomplete reply from server"});break}}}},remove:function(batch){if(!batch){dwr.engine._debug("Warning: null batch in dwr.engine.batch.remove()",true);return}if(batch.completed){return}batch.completed=true;dwr.engine.transport.remove(batch);if(batch.timeoutId!=null){clearTimeout(batch.timeoutId);delete batch.timeoutId}if(batch.map&&(batch.map.batchId||batch.map.batchId==0)){delete dwr.engine._batches[batch.map.batchId];dwr.engine._batchesLength--}if(dwr.engine._batchQueue.length!=0){var sendbatch=dwr.engine._batchQueue.shift();dwr.engine.transport.send(sendbatch)}}};dwr.engine.util={newActiveXObject:function(axarray){var returnValue;for(var i=0;i<axarray.length;i++){try{returnValue=new ActiveXObject(axarray[i]);break}catch(ex){}}return returnValue},tokenify:function(number){var tokenbuf=[];var charmap="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ*$";var remainder=number;while(remainder>0){tokenbuf.push(charmap.charAt(remainder&63));remainder=Math.floor(remainder/64)}return tokenbuf.join("")},addEventListener:function(elem,name,func){if(elem.addEventListener){elem.addEventListener(name,func,false)}else{elem.attachEvent("on"+name,func)}}};var userAgent=navigator.userAgent;var versionString=navigator.appVersion;var version=parseFloat(versionString);dwr.engine.isOpera=(userAgent.indexOf("Opera")>=0)?version:0;dwr.engine.isKhtml=(versionString.indexOf("Konqueror")>=0)||(versionString.indexOf("Safari")>=0)?version:0;dwr.engine.isSafari=(versionString.indexOf("Safari")>=0)?version:0;dwr.engine.isJaxerServer=(window.Jaxer&&Jaxer.isOnServer);var geckoPos=userAgent.indexOf("Gecko");dwr.engine.isMozilla=((geckoPos>=0)&&(!dwr.engine.isKhtml))?version:0;dwr.engine.isFF=0;dwr.engine.isIE=0;try{if(dwr.engine.isMozilla){dwr.engine.isFF=parseFloat(userAgent.split("Firefox/")[1].split(" ")[0])}if((document.all)&&(!dwr.engine.isOpera)){dwr.engine.isIE=parseFloat(versionString.split("MSIE ")[1].split(";")[0])}}catch(ex){}dwr.engine._pageId=dwr.engine.util.tokenify(new Date().getTime())+"-"+dwr.engine.util.tokenify(Math.random()*10000000000000000);dwr.engine.transport.updateDwrSessionFromCookie();if(!dwr.engine.isJaxerServer){dwr.engine.util.addEventListener(window,"unload",dwr.engine._unloader)}var g=dwr.engine._global;if(!g.dwr){g.dwr={}}if(!g.dwr._){g.dwr._=[]}dwr.engine._instanceId=g.dwr._.length;g.dwr._[dwr.engine._instanceId]={handleCallback:dwr.engine.remote.handleCallback,handleException:dwr.engine.remote.handleException,handleNewWindowName:dwr.engine.remote.handleNewWindowName,handleBatchException:dwr.engine.remote.handleBatchException,handleFunctionCall:dwr.engine.remote.handleFunctionCall,handleObjectCall:dwr.engine.remote.handleObjectCall,handleSetCall:dwr.engine.remote.handleSetCall,handleFunctionClose:dwr.engine.remote.handleFunctionClose,handleObjectCall:dwr.engine.remote.handleObjectCall,handleForeign:dwr.engine.remote.handleForeign,pollCometDisabled:dwr.engine.remote.pollCometDisabled,newObject:dwr.engine.remote.newObject,toDomElement:dwr.engine.serialize.toDomElement,toDomDocument:dwr.engine.serialize.toDomDocument,beginIFrameResponse:dwr.engine.transport.iframe.remote.beginIFrameResponse,endIFrameResponse:dwr.engine.transport.iframe.remote.endIFrameResponse,_eval:dwr.engine._eval};eval("dwr.engine._execute(dwr.engine._pathToDwrServlet, '__System', 'pageLoaded', [ function() { dwr.engine._ordered = false; }]);");dwr.hub={publish:function(topicName,data){dwr.engine._execute(dwr.engine._pathToDwrServlet,"__System","publish",topicName,data,{})},subscribe:function(topicName,callback,scope,subscriberData){var subscription=""+dwr.hub._subscriptionId;dwr.hub._subscriptionId++;dwr.hub._subscriptions[subscription]={callback:callback,scope:scope,subscriberData:subscriberData};dwr.engine._execute(dwr.engine._pathToDwrServlet,"__System","subscribe",topicName,subscription,{});return subscription},_remotePublish:function(subscriptionId,publishData){var subscriptionData=dwr.hub._subscriptions[subscriptionId];if(!subscriptionData){return}subscriptionData.callback.call(subscriptionData.scope,publishData,subscriptionData.subscriberData)},_subscriptionId:0,_subscriptions:{}};dwr.data={StoreChangeListener:{itemRemoved:function(source,itemId){},itemAdded:function(source,item){},itemChanged:function(source,item,changedAttributes){}},Cache:function(storeId,listener){this.storeId=storeId;this.listener=listener}};dwr.data.Cache.prototype.viewRegion=function(region,callbackObj){if(!region){region={}}if(!region.start){region.start=0}if(!region.count){region.count=-1}if(!region.sort){region.sort=[]}else{for(var index=0;index<region.sort.length;index++){if(typeof region.sort[index].descending=="undefined"){region.sort[index].descending=false}}}if(!region.query){region.query={}}return dwr.engine._execute(dwr.engine._pathToDwrServlet,"__Data","viewRegion",[this.storeId,region,this.listener,callbackObj])};dwr.data.Cache.prototype.viewItem=function(itemId,callbackObj){return dwr.engine._execute(dwr.engine._pathToDwrServlet,"__Data","viewItem",[this.storeId,itemId,this.listener,callbackObj])};dwr.data.Cache.prototype.unsubscribe=function(callbackObj){if(this.listener){return dwr.engine._execute(dwr.engine._pathToDwrServlet,"__Data","unsubscribe",[this.storeId,this.listener,callbackObj])}};dwr.data.Cache.prototype.update=function(items,callbackObj){return dwr.engine._execute(dwr.engine._pathToDwrServlet,"__Data","update",[this.storeId,items,callbackObj])}})();(function(){if(dwr.engine._getObject("Flux")==undefined){var p;p={};p._path="/betterform/Flux";p.init=function(p0,callback){return dwr.engine._execute(p._path,"Flux","init",arguments)};p.close=function(p0,callback){return dwr.engine._execute(p._path,"Flux","close",arguments)};p.setLocale=function(p0,p1,callback){return dwr.engine._execute(p._path,"Flux","setLocale",arguments)};p.getInstanceDocument=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"Flux","getInstanceDocument",arguments)};p.setRepeatIndex=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"Flux","setRepeatIndex",arguments)};p.dispatchEvent=function(p0,p1,callback){return dwr.engine._execute(p._path,"Flux","dispatchEvent",arguments)};p.dispatchEventType=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"Flux","dispatchEventType",arguments)};p.dispatchEventTypeWithContext=function(p0,p1,p2,p3,callback){return dwr.engine._execute(p._path,"Flux","dispatchEventTypeWithContext",arguments)};p.setUIControlValue=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"Flux","setUIControlValue",arguments)};p.setXFormsValue=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"Flux","setXFormsValue",arguments)};p.getXFormsDOM=function(p0,callback){return dwr.engine._execute(p._path,"Flux","getXFormsDOM",arguments)};p.fetchProgress=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"Flux","fetchProgress",arguments)};dwr.engine._setObject("Flux",p)}})();(function(){if(dwr.engine._getObject("XFormsModelElement")==undefined){var p;p={};p._path="/betterform/Flux";p.refresh=function(p0,p1,callback){return dwr.engine._execute(p._path,"XFormsModelElement","refresh",arguments)};p.revalidate=function(p0,p1,callback){return dwr.engine._execute(p._path,"XFormsModelElement","revalidate",arguments)};p.getInstanceDocument=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"XFormsModelElement","getInstanceDocument",arguments)};p.getInstanceAsString=function(p0,p1,p2,callback){return dwr.engine._execute(p._path,"XFormsModelElement","getInstanceAsString",arguments)};p.rebuild=function(p0,p1,callback){return dwr.engine._execute(p._path,"XFormsModelElement","rebuild",arguments)};p.recalculate=function(p0,p1,callback){return dwr.engine._execute(p._path,"XFormsModelElement","recalculate",arguments)};dwr.engine._setObject("XFormsModelElement",p)}})();if(!dwr.util){dwr.util={}}dwr.util._escapeHtml=true;dwr.util.setEscapeHtml=function(escapeHtml){dwr.util._escapeHtml=escapeHtml};dwr.util._shouldEscapeHtml=function(options){if(options&&options.escapeHtml!=null){return options.escapeHtml}return dwr.util._escapeHtml};dwr.util.escapeHtml=function(original){return original.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};dwr.util.unescapeHtml=function(original){return original.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&")};dwr.util.replaceXmlCharacters=function(original){original=original.replace("&","+");original=original.replace("<","\u2039");original=original.replace(">","\u203A");original=original.replace("'","\u2018");original=original.replace('"',"\u201C");return original};dwr.util.containsXssRiskyCharacters=function(original){return(original.indexOf("&")!=-1||original.indexOf("<")!=-1||original.indexOf(">")!=-1||original.indexOf("'")!=-1||original.indexOf('"')!=-1)};dwr.util.onReturn=function(event,action){if(!event){event=window.event}if(event&&event.keyCode&&event.keyCode==13){action()}};dwr.util.selectRange=function(ele,start,end){ele=dwr.util._getElementById(ele,"selectRange()");if(ele==null){return}if(ele.setSelectionRange){ele.setSelectionRange(start,end)}else{if(ele.createTextRange){var range=ele.createTextRange();range.moveStart("character",start);range.moveEnd("character",end-ele.value.length);range.select()}}ele.focus()};dwr.util.byId=function(){var elems=[];for(var i=0;i<arguments.length;i++){var idOrElem=arguments[i];var elem;if(typeof idOrElem=="string"){var elem=document.getElementById(idOrElem);if(document.all&&elem&&dwr.util._getId(elem)!=idOrElem){elem=null;var maybeElems=document.all[idOrElem];if(maybeElems.tagName){maybeElems=[maybeElems]}for(var j=0;j<maybeElems.length;j++){if(dwr.util._getId(maybeElems[j])==idOrElem){elem=maybeElems[j];break}}}}else{elem=idOrElem}if(arguments.length==1){return elem}elems.push(elem)}return elems};dwr.util._getId=function(elem){var elemId=elem.getAttribute("id");if(dwr.util._isObject(elemId)){elemId=elem.attributes.id.value}return elemId};if(typeof $=="undefined"){$=dwr.util.byId}dwr.util.toDescriptiveString=function(data,showLevels,options){if(showLevels===undefined){showLevels=1}var opt={};if(dwr.util._isObject(options)){opt=options}var defaultoptions={escapeHtml:false,baseIndent:"",childIndent:"\u00A0\u00A0",lineTerminator:"\n",oneLineMaxItems:5,shortStringMaxLength:13,propertyNameMaxLength:30};for(var p in defaultoptions){if(!(p in opt)){opt[p]=defaultoptions[p]}}var skipDomProperties={document:true,ownerDocument:true,all:true,parentElement:true,parentNode:true,offsetParent:true,children:true,firstChild:true,lastChild:true,previousSibling:true,nextSibling:true,innerHTML:true,outerHTML:true,innerText:true,outerText:true,textContent:true,attributes:true,style:true,currentStyle:true,runtimeStyle:true,parentTextEdit:true};function recursive(data,showLevels,indentDepth,options){var reply="";try{if(dwr.util._isString(data)){var str=data;if(showLevels==0&&str.length>options.shortStringMaxLength){str=str.substring(0,options.shortStringMaxLength-3)+"..."}if(options.escapeHtml){var lines=str.split("\n");for(var i=0;i<lines.length;i++){lines[i]=dwr.util.escapeHtml(lines[i])}str=lines.join("\n")}if(showLevels==0){str=str.replace(/\n|\r|\t/g,function(ch){switch(ch){case"\n":return"\\n";case"\r":return"";case"\t":return"\\t"}})}else{str=str.replace(/\n|\r|\t/g,function(ch){switch(ch){case"\n":return options.lineTerminator+indent(indentDepth+1,options);case"\r":return"";case"\t":return"\\t"}})}reply='"'+str+'"'}else{if(dwr.util._isFunction(data)){reply="function"}else{if(dwr.util._isArrayLike(data)){if(showLevels==0){if(data.length>0){reply="[...]"}else{reply="[]"}}else{var strarr=[];strarr.push("[");var count=0;for(var i=0;i<data.length;i++){if(!(i in data)&&data!="[object NodeList]"){continue}var itemvalue=data[i];if(count>0){strarr.push(", ")}if(showLevels==1){if(count==options.oneLineMaxItems){strarr.push("...");break}}else{strarr.push(options.lineTerminator+indent(indentDepth+1,options))}if(i!=count){strarr.push(i);strarr.push(":")}strarr.push(recursive(itemvalue,showLevels-1,indentDepth+1,options));count++}if(showLevels>1){strarr.push(options.lineTerminator+indent(indentDepth,options))}strarr.push("]");reply=strarr.join("")}}else{if(dwr.util._isObject(data)&&!dwr.util._isDate(data)){if(showLevels==0){reply=dwr.util._detailedTypeOf(data)}else{var strarr=[];if(dwr.util._detailedTypeOf(data)!="Object"){strarr.push(dwr.util._detailedTypeOf(data));if(typeof data.valueOf()!="object"){strarr.push(":");strarr.push(recursive(data.valueOf(),1,indentDepth,options))}strarr.push(" ")}strarr.push("{");var isDomObject=dwr.util._isHTMLElement(data);var count=0;for(var prop in data){var propvalue=data[prop];if(isDomObject){if(propvalue==null){continue}if(typeof propvalue=="function"){continue}if(skipDomProperties[prop]){continue}if(prop.toUpperCase()==prop){continue}}if(count>0){strarr.push(", ")}if(showLevels==1){if(count==options.oneLineMaxItems){strarr.push("...");break}}else{strarr.push(options.lineTerminator+indent(indentDepth+1,options))}strarr.push(prop.length>options.propertyNameMaxLength?prop.substring(0,options.propertyNameMaxLength-3)+"...":prop);strarr.push(":");strarr.push(recursive(propvalue,showLevels-1,indentDepth+1,options));count++}if(showLevels>1&&count>0){strarr.push(options.lineTerminator+indent(indentDepth,options))}strarr.push("}");reply=strarr.join("")}}else{reply=""+data}}}}return reply}catch(err){return(err.message?err.message:""+err)}}function indent(count,options){var strarr=[];strarr.push(options.baseIndent);for(var i=0;i<count;i++){strarr.push(options.childIndent)}return strarr.join("")}return recursive(data,showLevels,0,opt)};dwr.util.useLoadingMessage=function(message){var loadingMessage;if(message){loadingMessage=message}else{loadingMessage="Loading"}dwr.engine.setPreHook(function(){var disabledZone=dwr.util.byId("disabledZone");if(!disabledZone){disabledZone=document.createElement("div");disabledZone.setAttribute("id","disabledZone");disabledZone.style.position="absolute";disabledZone.style.zIndex="1000";disabledZone.style.left="0px";disabledZone.style.top="0px";disabledZone.style.width="100%";disabledZone.style.height="100%";if(window.ActiveXObject){disabledZone.style.background="white";disabledZone.style.filter="alpha(opacity=0)"}document.body.appendChild(disabledZone);var messageZone=document.createElement("div");messageZone.setAttribute("id","messageZone");messageZone.style.position="absolute";messageZone.style.top="0px";messageZone.style.right="0px";messageZone.style.background="red";messageZone.style.color="white";messageZone.style.fontFamily="Arial,Helvetica,sans-serif";messageZone.style.padding="4px";document.body.appendChild(messageZone);var text=document.createTextNode(loadingMessage);messageZone.appendChild(text);dwr.util._disabledZoneUseCount=1}else{dwr.util.byId("messageZone").innerHTML=loadingMessage;disabledZone.style.visibility="visible";dwr.util._disabledZoneUseCount++;dwr.util.byId("messageZone").style.visibility="visible"}});dwr.engine.setPostHook(function(){dwr.util._disabledZoneUseCount--;if(dwr.util._disabledZoneUseCount==0){dwr.util.byId("disabledZone").style.visibility="hidden";dwr.util.byId("messageZone").style.visibility="hidden"}})};dwr.util.setHighlightHandler=function(handler){dwr.util._highlightHandler=handler};dwr.util.yellowFadeHighlightHandler=function(ele){dwr.util._yellowFadeProcess(ele,0)};dwr.util._yellowFadeSteps=["d0","b0","a0","90","98","a0","a8","b0","b8","c0","c8","d0","d8","e0","e8","f0","f8"];dwr.util._yellowFadeProcess=function(ele,colorIndex){ele=dwr.util.byId(ele);if(colorIndex<dwr.util._yellowFadeSteps.length){ele.style.backgroundColor="#ffff"+dwr.util._yellowFadeSteps[colorIndex];setTimeout("dwr.util._yellowFadeProcess('"+dwr.util._getId(ele)+"',"+(colorIndex+1)+")",200)}else{ele.style.backgroundColor="transparent"}};dwr.util.borderFadeHighlightHandler=function(ele){ele.style.borderWidth="2px";ele.style.borderStyle="solid";dwr.util._borderFadeProcess(ele,0)};dwr.util._borderFadeSteps=["d0","b0","a0","90","98","a0","a8","b0","b8","c0","c8","d0","d8","e0","e8","f0","f8"];dwr.util._borderFadeProcess=function(ele,colorIndex){ele=dwr.util.byId(ele);if(colorIndex<dwr.util._borderFadeSteps.length){ele.style.borderColor="#ff"+dwr.util._borderFadeSteps[colorIndex]+dwr.util._borderFadeSteps[colorIndex];setTimeout("dwr.util._borderFadeProcess('"+dwr.util._getId(ele)+"',"+(colorIndex+1)+")",200)}else{ele.style.backgroundColor="transparent"}};dwr.util.focusHighlightHandler=function(ele){try{ele.focus()}catch(ex){}};dwr.util._highlightHandler=null;dwr.util.highlight=function(ele,options){if(options&&options.highlightHandler){options.highlightHandler(dwr.util.byId(ele))}else{if(dwr.util._highlightHandler!=null){dwr.util._highlightHandler(dwr.util.byId(ele))}}};dwr.util.setValue=function(ele,val,options){if(val==null){val=""}if(options==null){options={}}var orig=ele;ele=dwr.util.byId(ele);var nodes=null;if(ele==null){nodes=document.getElementsByName(orig);if(nodes.length>=1){ele=nodes.item(0)}}if(ele==null){dwr.util._debug("setValue() can't find an element with id/name: "+orig+".");return}dwr.util.highlight(ele,options);if(dwr.util._isHTMLElement(ele,"select")){if(ele.type=="select-multiple"&&dwr.util._isArray(val)){dwr.util._selectListItems(ele,val)}else{dwr.util._selectListItem(ele,val)}return}if(dwr.util._isHTMLElement(ele,"input")){if(ele.type=="radio"||ele.type=="checkbox"){if(nodes&&nodes.length>=1){for(var i=0;i<nodes.length;i++){var node=nodes.item(i);if(node.type!=ele.type){continue}if(dwr.util._isArray(val)){node.checked=false;for(var j=0;j<val.length;j++){if(val[j]==node.value){node.checked=true}}}else{node.checked=(node.value==val)}}}else{ele.checked=(val==true)}}else{ele.value=val}return}if(dwr.util._isHTMLElement(ele,"textarea")){ele.value=val;return}if(dwr.util._isHTMLElement(ele,"img")){ele.src=val;return}if(val.nodeType){if(val.nodeType==9){val=val.documentElement}val=dwr.util._importNode(ele.ownerDocument,val,true);ele.appendChild(val);return}if(dwr.util._shouldEscapeHtml(options)){if("textContent" in ele){ele.textContent=val.toString()}else{if("innerText" in ele){ele.innerText=val.toString()}else{ele.innerHTML=dwr.util.escapeHtml(val.toString())}}}else{ele.innerHTML=val}};dwr.util._selectListItems=function(ele,val){var found=0;var i;var j;for(i=0;i<ele.options.length;i++){ele.options[i].selected=false;for(j=0;j<val.length;j++){if(ele.options[i].value==val[j]){ele.options[i].selected=true;found++}}}if(found==val.length){return}for(i=0;i<ele.options.length;i++){for(j=0;j<val.length;j++){if(ele.options[i].text==val[j]){ele.options[i].selected=true}}}};dwr.util._selectListItem=function(ele,val){var found=false;var i;for(i=0;i<ele.options.length;i++){if(ele.options[i].value==val){ele.options[i].selected=true;found=true}else{ele.options[i].selected=false}}if(found){return}for(i=0;i<ele.options.length;i++){ele.options[i].selected=(ele.options[i].text==val)}};dwr.util.getValue=function(ele,options){if(options==null){options={}}var orig=ele;ele=dwr.util.byId(ele);var nodes=null;if(ele==null){nodes=document.getElementsByName(orig);if(nodes.length>=1){ele=nodes.item(0)}}if(ele==null){dwr.util._debug("getValue() can't find an element with id/name: "+orig+".");return""}if(dwr.util._isHTMLElement(ele,"select")){if(ele.type=="select-multiple"){var reply=new Array();for(var i=0;i<ele.options.length;i++){var item=ele.options[i];if(item.selected){var valueAttr=item.getAttributeNode("value");if(valueAttr&&valueAttr.specified){reply.push(item.value)}else{reply.push(item.text)}}}return reply}else{var sel=ele.selectedIndex;if(sel!=-1){var item=ele.options[sel];var valueAttr=item.getAttributeNode("value");if(valueAttr&&valueAttr.specified){return item.value}return item.text}else{return""}}}if(dwr.util._isHTMLElement(ele,"input")){if(ele.type=="radio"){if(nodes&&nodes.length>=1){for(var i=0;i<nodes.length;i++){var node=nodes.item(i);if(node.type==ele.type){if(node.checked){return node.value}}}}return ele.checked}if(ele.type=="checkbox"){if(nodes&&nodes.length>=1){var reply=[];for(var i=0;i<nodes.length;i++){var node=nodes.item(i);if(node.type==ele.type){if(node.checked){reply.push(node.value)}}}return reply}return ele.checked}if(ele.type=="file"){return ele}return ele.value}if(dwr.util._isHTMLElement(ele,"textarea")){return ele.value}if(dwr.util._shouldEscapeHtml(options)){if("textContent" in ele){return ele.textContent}else{if("innerText" in ele){return ele.innerText}}}return ele.innerHTML};dwr.util.getText=function(ele){ele=dwr.util._getElementById(ele,"getText()");if(ele==null){return null}if(!dwr.util._isHTMLElement(ele,"select")){dwr.util._debug("getText() can only be used with select elements. Attempt to use: "+dwr.util._detailedTypeOf(ele)+" from  id: "+orig+".");return""}var sel=ele.selectedIndex;if(sel!=-1){return ele.options[sel].text}else{return""}};dwr.util.setValues=function(data,options){var prefix="";var depth=100;if(options&&"prefix" in options){prefix=options.prefix}if(options&&"idPrefix" in options){prefix=options.idPrefix}if(options&&"depth" in options){depth=options.depth}dwr.util._setValuesRecursive(data,prefix,depth,options)};dwr.util._setValuesRecursive=function(data,idpath,depth,options){if(depth==0){return}if(dwr.util._isArray(data)&&data.length>0&&dwr.util._isObject(data[0])){for(var i=0;i<data.length;i++){dwr.util._setValuesRecursive(data[i],idpath+"["+i+"]",depth-1,options)}}else{if(dwr.util._isObject(data)&&!dwr.util._isArray(data)){for(var prop in data){var subidpath=idpath?idpath+"."+prop:prop;if(dwr.util._isObject(data[prop])&&!dwr.util._isArray(data[prop])&&!dwr.util._isDate(data[prop])||dwr.util._isArray(data[prop])&&data[prop].length>0&&dwr.util._isObject(data[prop][0])){dwr.util._setValuesRecursive(data[prop],subidpath,depth-1,options)}else{if(typeof data[prop]=="function"){}else{if(dwr.util.byId(subidpath)!=null||document.getElementsByName(subidpath).length>=1){dwr.util.setValue(subidpath,data[prop],options)}}}}}}};dwr.util.getValues=function(data,options){if(typeof data=="string"||dwr.util._isHTMLElement(data)){return dwr.util.getFormValues(data)}else{var prefix="";var depth=100;if(options!=null&&"prefix" in options){prefix=options.prefix}if(options!=null&&"idPrefix" in options){prefix=options.idPrefix}if(options!=null&&"depth" in options){depth=options.depth}dwr.util._getValuesRecursive(data,prefix,depth,options);return data}};dwr.util.getFormValues=function(eleOrNameOrId){var ele=null;if(typeof eleOrNameOrId=="string"){ele=document.forms[eleOrNameOrId];if(ele==null){ele=dwr.util.byId(eleOrNameOrId)}}else{if(dwr.util._isHTMLElement(eleOrNameOrId)){ele=eleOrNameOrId}}if(ele!=null){if(ele.elements==null){alert("getFormValues() requires an object or reference to a form element.");return null}var reply={};var name;var value;for(var i=0;i<ele.elements.length;i++){if(ele[i].type in {button:0,submit:0,reset:0,image:0,file:0}){continue}if(ele[i].name){name=ele[i].name;value=dwr.util.getValue(name)}else{if(ele[i].id){name=ele[i].id}else{name="element"+i}value=dwr.util.getValue(ele[i])}reply[name]=value}return reply}};dwr.util._getValuesRecursive=function(data,idpath,depth,options){if(depth==0){return}if(dwr.util._isArray(data)&&data.length>0&&dwr.util._isObject(data[0])){for(var i=0;i<data.length;i++){dwr.util._getValuesRecursive(data[i],idpath+"["+i+"]",depth-1,options)}}else{if(dwr.util._isObject(data)&&!dwr.util._isArray(data)){for(var prop in data){var subidpath=idpath?idpath+"."+prop:prop;if(dwr.util._isObject(data[prop])&&!dwr.util._isArray(data[prop])||dwr.util._isArray(data[prop])&&data[prop].length>0&&dwr.util._isObject(data[prop][0])){dwr.util._getValuesRecursive(data[prop],subidpath,depth-1,options)}else{if(typeof data[prop]=="function"){}else{if(dwr.util.byId(subidpath)!=null||document.getElementsByName(subidpath).length>=1){data[prop]=dwr.util.getValue(subidpath)}}}}}}};dwr.util.addOptions=function(ele,data){ele=dwr.util._getElementById(ele,"addOptions()");if(ele==null){return}var useOptions=dwr.util._isHTMLElement(ele,"select");var useLi=dwr.util._isHTMLElement(ele,["ul","ol"]);if(!useOptions&&!useLi){dwr.util._debug("addOptions() can only be used with select/ul/ol elements. Attempt to use: "+dwr.util._detailedTypeOf(ele));return}if(data==null){return}var argcount=arguments.length;var options={};var lastarg=arguments[argcount-1];if(argcount>2&&dwr.util._isObject(lastarg)){options=lastarg;argcount--}var arg3=null;if(argcount>=3){arg3=arguments[2]}var arg4=null;if(argcount>=4){arg4=arguments[3]}if(!options.optionCreator&&useOptions){options.optionCreator=dwr.util._defaultOptionCreator}if(!options.optionCreator&&useLi){options.optionCreator=dwr.util._defaultListItemCreator}options.document=ele.ownerDocument;var text,value,li;if(dwr.util._isArray(data)){for(var i=0;i<data.length;i++){options.data=data[i];options.text=null;options.value=null;if(useOptions){if(arg3!=null){if(arg4!=null){options.text=dwr.util._getValueFrom(data[i],arg4);options.value=dwr.util._getValueFrom(data[i],arg3)}else{options.text=options.value=dwr.util._getValueFrom(data[i],arg3)}}else{options.text=options.value=dwr.util._getValueFrom(data[i])}if(options.text!=null||options.value){var opt=options.optionCreator(options);opt.text=options.text;opt.value=options.value;ele.options[ele.options.length]=opt}}else{options.value=dwr.util._getValueFrom(data[i],arg3);if(options.value!=null){li=options.optionCreator(options);if(dwr.util._shouldEscapeHtml(options)){options.value=dwr.util.escapeHtml(options.value)}li.innerHTML=options.value;ele.appendChild(li)}}}}else{if(arg4!=null){if(!useOptions){alert("dwr.util.addOptions can only create select lists from objects.");return}for(var prop in data){options.data=data[prop];options.value=dwr.util._getValueFrom(data[prop],arg3);options.text=dwr.util._getValueFrom(data[prop],arg4);if(options.text!=null||options.value){var opt=options.optionCreator(options);opt.text=options.text;opt.value=options.value;ele.options[ele.options.length]=opt}}}else{if(!useOptions){dwr.util._debug("dwr.util.addOptions can only create select lists from objects.");return}for(var prop in data){if(typeof data[prop]=="function"){continue}options.data=data[prop];if(arg3==null){options.value=prop;options.text=data[prop]}else{options.value=data[prop];options.text=prop}if(options.text!=null||options.value){var opt=options.optionCreator(options);opt.text=options.text;opt.value=options.value;ele.options[ele.options.length]=opt}}}}dwr.util.highlight(ele,options)};dwr.util._getValueFrom=function(data,method){if(method==null){return data}else{if(typeof method=="function"){return method(data)}else{return data[method]}}};dwr.util._defaultOptionCreator=function(options){return options.document.createElement("option")};dwr.util._defaultListItemCreator=function(options){return options.document.createElement("li")};dwr.util.removeAllOptions=function(ele){ele=dwr.util._getElementById(ele,"removeAllOptions()");if(ele==null){return}var useOptions=dwr.util._isHTMLElement(ele,"select");var useLi=dwr.util._isHTMLElement(ele,["ul","ol"]);if(!useOptions&&!useLi){dwr.util._debug("removeAllOptions() can only be used with select, ol and ul elements. Attempt to use: "+dwr.util._detailedTypeOf(ele));return}if(useOptions){ele.options.length=0}else{while(ele.childNodes.length>0){ele.removeChild(ele.firstChild)}}};dwr.util.addRows=function(ele,data,cellFuncs,options){ele=dwr.util._getElementById(ele,"addRows()");if(ele==null){return}if(!dwr.util._isHTMLElement(ele,["table","tbody","thead","tfoot"])){dwr.util._debug("addRows() can only be used with table, tbody, thead and tfoot elements. Attempt to use: "+dwr.util._detailedTypeOf(ele));return}if(!options){options={}}if(!options.rowCreator){options.rowCreator=dwr.util._defaultRowCreator}if(!options.cellCreator){options.cellCreator=dwr.util._defaultCellCreator}options.document=ele.ownerDocument;var tr,rowNum;if(dwr.util._isArray(data)){for(rowNum=0;rowNum<data.length;rowNum++){options.rowData=data[rowNum];options.rowIndex=rowNum;options.rowNum=rowNum;options.data=null;options.cellNum=-1;tr=dwr.util._addRowInner(cellFuncs,options);if(tr!=null){ele.appendChild(tr)}}}else{if(typeof data=="object"){rowNum=0;for(var rowIndex in data){options.rowData=data[rowIndex];options.rowIndex=rowIndex;options.rowNum=rowNum;options.data=null;options.cellNum=-1;tr=dwr.util._addRowInner(cellFuncs,options);if(tr!=null){ele.appendChild(tr)}rowNum++}}}dwr.util.highlight(ele,options)};dwr.util._emptyTableCellReplacement="<div style='width:0;height:0;overflow:hidden;'></div>";dwr.util._addRowInner=function(cellFuncs,options){var tr=options.rowCreator(options);if(tr==null){return null}for(var cellNum=0;cellNum<cellFuncs.length;cellNum++){var func=cellFuncs[cellNum];if(typeof func=="function"){options.data=func(options.rowData,options)}else{options.data=func||""}options.cellNum=cellNum;var td=options.cellCreator(options);if(td!=null){if("data" in options){if(dwr.util._isHTMLElement(options.data)){td.appendChild(options.data)}else{if(dwr.util._shouldEscapeHtml(options)&&typeof(options.data)=="string"){td.innerHTML=dwr.util.escapeHtml(options.data)}else{td.innerHTML=options.data}}}else{td.innerHTML=dwr.util._emptyTableCellReplacement}tr.appendChild(td)}}return tr};dwr.util._defaultRowCreator=function(options){return options.document.createElement("tr")};dwr.util._defaultCellCreator=function(options){return options.document.createElement("td")};dwr.util.removeAllRows=function(ele,options){ele=dwr.util._getElementById(ele,"removeAllRows()");if(ele==null){return}if(!options){options={}}if(!options.filter){options.filter=function(){return true}}if(!dwr.util._isHTMLElement(ele,["table","tbody","thead","tfoot"])){dwr.util._debug("removeAllRows() can only be used with table, tbody, thead and tfoot elements. Attempt to use: "+dwr.util._detailedTypeOf(ele));return}var child=ele.firstChild;var next;while(child!=null){next=child.nextSibling;if(options.filter(child)){ele.removeChild(child)}child=next}};dwr.util.setClassName=function(ele,className){ele=dwr.util._getElementById(ele,"setClassName()");if(ele==null){return}ele.className=className};dwr.util.addClassName=function(ele,className){ele=dwr.util._getElementById(ele,"addClassName()");if(ele==null){return}ele.className+=" "+className};dwr.util.removeClassName=function(ele,className){ele=dwr.util._getElementById(ele,"removeClassName()");if(ele==null){return}var regex=new RegExp("(^|\\s)"+className+"(\\s|$)","g");ele.className=ele.className.replace(regex,"")};dwr.util.toggleClassName=function(ele,className){ele=dwr.util._getElementById(ele,"toggleClassName()");if(ele==null){return}var regex=new RegExp("(^|\\s)"+className+"(\\s|$)");if(regex.test(ele.className)){ele.className=ele.className.replace(regex,"")}else{ele.className+=" "+className}};dwr.util.cloneNode=function(ele,options){ele=dwr.util._getElementById(ele,"cloneNode()");if(ele==null){return null}if(options==null){options={}}var clone=ele.cloneNode(true);if("idPrefix" in options||"idSuffix" in options){dwr.util._updateIds(clone,options)}else{dwr.util._removeIds(clone)}ele.parentNode.insertBefore(clone,ele);return clone};dwr.util._updateIds=function(ele,options){if(options==null){options={}}if(dwr.util._getId(ele)){ele.setAttribute("id",("idPrefix" in options?options.idPrefix:"")+dwr.util._getId(ele)+("idSuffix" in options?options.idSuffix:""))}var children=ele.childNodes;for(var i=0;i<children.length;i++){var child=children.item(i);if(child.nodeType==1){dwr.util._updateIds(child,options)}}};dwr.util._removeIds=function(ele){if(dwr.util._getId(ele)){ele.removeAttribute("id")}var children=ele.childNodes;for(var i=0;i<children.length;i++){var child=children.item(i);if(child.nodeType==1){dwr.util._removeIds(child)}}};dwr.util.cloneNodeForValues=function(templateEle,data,options){templateEle=dwr.util._getElementById(templateEle,"cloneNodeForValues()");if(templateEle==null){return null}if(options==null){options={}}var idpath;if(options.idPrefix!=null){idpath=options.idPrefix}else{idpath=dwr.util._getId(templateEle)||""}return dwr.util._cloneNodeForValuesRecursive(templateEle,data,idpath,options)};dwr.util._cloneNodeForValuesRecursive=function(templateEle,data,idpath,options){if(dwr.util._isArray(data)){var clones=[];for(var i=0;i<data.length;i++){var item=data[i];var clone=dwr.util._cloneNodeForValuesRecursive(templateEle,item,idpath+"["+i+"]",options);clones.push(clone)}return clones}else{if(dwr.util._isObject(data)&&!dwr.util._isArray(data)){var clone=templateEle.cloneNode(true);if(options.updateCloneStyle&&clone.style){for(var propname in options.updateCloneStyle){clone.style[propname]=options.updateCloneStyle[propname]}}dwr.util._replaceIds(clone,dwr.util._getId(templateEle),idpath);templateEle.parentNode.insertBefore(clone,templateEle);dwr.util._cloneSubArrays(data,idpath,options);return clone}}return null};dwr.util._replaceIds=function(ele,oldidpath,newidpath){var currId=dwr.util._getId(ele);if(currId){var newId=null;if(currId==oldidpath){newId=newidpath}else{if(currId.length>oldidpath.length){if(currId.substr(0,oldidpath.length)==oldidpath){var trailingChar=currId.charAt(oldidpath.length);if(trailingChar=="."||trailingChar=="["){newId=newidpath+currId.substr(oldidpath.length)}}}}if(newId){ele.setAttribute("id",newId)}else{ele.removeAttribute("id")}}var children=ele.childNodes;for(var i=0;i<children.length;i++){var child=children.item(i);if(child.nodeType==1){dwr.util._replaceIds(child,oldidpath,newidpath)}}};dwr.util._cloneSubArrays=function(data,idpath,options){for(prop in data){var value=data[prop];if(dwr.util._isArray(value)){if(value.length>0&&dwr.util._isObject(value[0])){var subTemplateId=idpath+"."+prop;var subTemplateEle=dwr.util.byId(subTemplateId);if(subTemplateEle!=null){dwr.util._cloneNodeForValuesRecursive(subTemplateEle,value,subTemplateId,options)}}}else{if(dwr.util._isObject(value)){dwr.util._cloneSubArrays(value,idpath+"."+prop,options)}}}};dwr.util._getElementById=function(ele,source){var orig=ele;ele=dwr.util.byId(ele);if(ele==null){dwr.util._debug(source+" can't find an element with id: "+orig+".")}return ele};dwr.util._isHTMLElement=function(ele,nodeName){if(ele==null||typeof ele!="object"||ele.nodeName==null){return false}if(nodeName!=null){var test=ele.nodeName.toLowerCase();if(typeof nodeName=="string"){return test==nodeName.toLowerCase()}if(dwr.util._isArray(nodeName)){var match=false;for(var i=0;i<nodeName.length&&!match;i++){if(test==nodeName[i].toLowerCase()){match=true}}return match}dwr.util._debug("dwr.util._isHTMLElement was passed test node name that is neither a string or array of strings");return false}return true};dwr.util._detailedTypeOf=function(x){var reply=typeof x;if(reply=="object"){reply=Object.prototype.toString.apply(x);reply=reply.substring(8,reply.length-1)}return reply};dwr.util._isObject=function(data){return(data&&typeof data=="object")};dwr.util._isArray=function(data){return(data&&Object.prototype.toString.call(data)=="[object Array]")};dwr.util._isArrayLike=function(data){return data&&(typeof data.length=="number")&&((data.propertyIsEnumerable&&data.propertyIsEnumerable("length")==false)||!data.constructor||data!="[object Object]")&&!dwr.util._isString(data)&&!dwr.util._isFunction(data)&&!data.tagName};dwr.util._isString=function(data){return(data&&(typeof data=="string"||Object.prototype.toString.call(data)=="[object String]"))};dwr.util._isFunction=function(data){return(data&&(typeof data=="function"||Object.prototype.toString.call(data)=="[object Function]")&&data!="[object NodeList]")};dwr.util._isDate=function(data){return(data&&Object.prototype.toString.call(data)=="[object Date]")};dwr.util._importNode=function(doc,importedNode,deep){var newNode;if(importedNode.nodeType==1){newNode=doc.createElement(importedNode.nodeName);for(var i=0;i<importedNode.attributes.length;i++){var attr=importedNode.attributes[i];if(attr.nodeValue!=null&&attr.nodeValue!=""){newNode.setAttribute(attr.name,attr.nodeValue)}}if(importedNode.style!=null){newNode.style.cssText=importedNode.style.cssText}}else{if(importedNode.nodeType==3){newNode=doc.createTextNode(importedNode.nodeValue)}}if(deep&&importedNode.hasChildNodes()){for(i=0;i<importedNode.childNodes.length;i++){newNode.appendChild(dwr.util._importNode(doc,importedNode.childNodes[i],true))}}return newNode};dwr.util._debug=function(message,stacktrace){var written=false;try{if(window.console){if(stacktrace&&window.console.trace){window.console.trace()}window.console.log(message);written=true}else{if(window.opera&&window.opera.postError){window.opera.postError(message);written=true}}}catch(ex){}if(!written){var debug=document.getElementById("dwr-debug");if(debug){var contents=message+"<br/>"+debug.innerHTML;if(contents.length>2048){contents=contents.substring(0,2048)}debug.innerHTML=contents}}};