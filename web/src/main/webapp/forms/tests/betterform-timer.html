<polymer-element name="betterform-timer">
    <template>
        <span class="timer">
            <span id="hour">00</span>
            :
            <span id="minute">00</span>
            :
            <span id="second">00</span>
        </span>
    </template>
    <script>
        Polymer('betterform-timer', {
            timer:null,
            startDateTime:null,
            endDateTime:null,

            start:function(){
                this.timer.start();
                this.startDateTime = new Date().toISOString();
                // var currentdate = new Date();
                // var currentTime = currentdate.getHours() + ":" + currentdate.getMinutes() + ":" + currentdate.getSeconds();
            },

            stop:function(){
                this.timer.stop();
                this.endDateTime = new Date().toISOString();
            },

            getTime:function(){
                return this.timer.getTime();
            },

            getStartDateTime:function(){
                return this.startDateTime;
            },

            getEndDateTime:function(){
                return this.endDateTime;
            },

            getStatus:function(){
                return this.timer.getStatus();
            },

            reset:function(){
                this.timer.reset();
            },

            ready: function () {
                this.timer = new _timer
                (
                        function(time)
                        {
                            if(time == 0)
                            {
                                this.timer.stop();
                                alert('time out');
                            }
                        }
                );
                this.timer.reset(0);
                this.timer.mode(1);
            }


        });

        function _timer(callback)
        {
            var time = 0;     //  The default time of the timer
            var mode = 1;     //    Mode: count up or count down
            var status = 0;    //    Status: timer is running or stoped
            var timer_id;    //    This is used by setInterval function

            // this will start the timer ex. start the timer with 1 second interval timer.start(1000)
            this.start = function(interval)
            {

                interval = (typeof(interval) !== 'undefined') ? interval : 1000;

                if(status == 0)
                {
                    status = 1;
                    timer_id = setInterval(function()
                    {
                        switch(mode)
                        {
                            default:
                                if(time)
                                {
                                    time--;
                                    generateTime();
                                    if(typeof(callback) === 'function') callback(time);
                                }
                                break;

                            case 1:
                                if(time < 86400)
                                {
                                    time++;
                                    generateTime();
                                    if(typeof(callback) === 'function') callback(time);
                                }
                                break;
                        }
                    }, interval);
                }
            }

            //  Same as the name, this will stop or pause the timer ex. timer.stop()
            this.stop =  function()
            {
                if(status == 1)
                {
                    status = 0;
                    clearInterval(timer_id);
                }
            }

            // Reset the timer to zero or reset it to your own custom time ex. reset to zero second timer.reset(0)
            this.reset =  function(sec)
            {
                sec = (typeof(sec) !== 'undefined') ? sec : 0;
                time = sec;
                generateTime(time);
            }

            // Change the mode of the timer, count-up (1) or countdown (0)
            this.mode = function(tmode)
            {
                mode = tmode;
            }

            // This methode return the current value of the timer
            this.getTime = function()
            {
                return time;
            }

            // This methode return the current mode of the timer count-up (1) or countdown (0)
            this.getMode = function()
            {
                return mode;
            }

            // This methode return the status of the timer running (1) or stoped (1)
            this.getStatus = function()
            {
                return status;
            }


            // This methode will render the time variable to hour:minute:second format
            function generateTime()
            {
                var second = time % 60;
                var minute = Math.floor(time / 60) % 60;
                var hour = Math.floor(time / 3600) % 60;

                second = (second < 10) ? '0'+second : second;
                minute = (minute < 10) ? '0'+minute : minute;
                hour = (hour < 10) ? '0'+hour : hour;

                jQuery('#second').html(second);
                jQuery('#minute').html(minute);
                jQuery('#hour').html(hour);
            }

        }

    </script>
</polymer-element>